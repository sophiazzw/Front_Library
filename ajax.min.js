!function(a){a.ajax=function(a){return new ajax.init(a.type||"get",a.url||"",a.user||null,a.password||null,a.send||null,a.error,a.beforeSend,a.success,a.code||"utf-8")},ajax.init=function(a,b,c,d,e,f,g,h,i){this.XHR=null,this.method=a,this.url=b,this.user=c,this.pwd=d,this.data=e,this.code=i,this.getDataInfo(),this.error=f,this.beforeSend=g,this.success=h},ajax.init.prototype={createXHR:function(){try{return new XMLHttpRequest}catch(a){var c,b=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],d=b.length;for(c=0;d>c;c+=1)try{return new ActiveXObject(b[c])}catch(a){return null}}},getDataInfo:function(){var a=this,b=/\?/,c=a.changeCode(a.data),d=b.test(a.url)?a.data?a.url.substring(0,a.url.search(b)):a.url:a.url;return"get"==a.method&&(a.data&&(d+="?"+c),c=null),a.XHR=a.createXHR(),a.XHR?(a.XHR.open(a.method,d,!0),a.XHR.onreadystatechange=function(){a.updatePage(a,this)},a.XHR.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset="+a.code),a.XHR.send(c),void 0):!1},updatePage:function(a,b){if(4==b.readyState)switch(this.beforeSend.call(b,b.status,"beforeSend"),b.status){case 200:a.success.call(b,b.responseText,b.status,"success");break;case 404:a.error.call(b,b.status,"error")}},changeCode:function(a){var b=function(a){var b=[];for(var c in a)b.push(c+"="+a[c]);return b};if("object"==typeof a)return b(a).join("&");if("string"==typeof a){var c=/{/g.test(a)?JSON.parse(a):a;return"string"==typeof c?c:b(c).join("&")}}}}(window);